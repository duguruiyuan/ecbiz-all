<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mlj.ecbiz.model.permission.SysUserMapper">
 	<!-- 以下两个<cache>标签二选一,第一个可以输出日志,第二个不输出日志 -->  
    <!--<cache type="org.mybatis.caches.ehcache.LoggingEhcache"/>  -->
    <!--<cache type="org.mybatis.caches.ehcache.EhcacheCache"/>   -->
    <resultMap id="SysUserResult" type="com.mlj.ecbiz.model.permission.SysUser">
        <result property="id" column="id"/>
        <result property="userName" column="user_name"/>
        <result property="userPassword" column="user_password"/>
        <result property="nickname" column="nickname"/>
        <result property="email" column="email"/>
        <result property="loginIp" column="login_ip"/>
        <result property="addTime" column="add_time"/>
        <result property="loginTime" column="login_time"/>
        <result property="roleId" column="role_id"/>
    </resultMap>

    <sql id="sys_user_columns">
        sys_user.id,
        sys_user.user_name,
        sys_user.user_password,
        sys_user.nickname,
        sys_user.email,
        sys_user.login_ip,
        sys_user.add_time,
        sys_user.login_time,
        sys_user.role_id
    </sql>
    
    <sql id="sys_user_where_conditions">
    	<trim prefix="where" prefixOverrides="and|or">
        <if test="id != null">
        	and id=#{id} 
        </if>
        
        <if test="userName != null and userName != ''">
        	and user_name=#{userName} 
        </if>
        
        <if test="userPassword != null and userPassword != ''">
        	and user_password=#{userPassword} 
        </if>
        
        <if test="nickname != null and nickname != ''">
        	and nickname=#{nickname} 
        </if>
        
        <if test="email != null and email != ''">
        	and email=#{email} 
        </if>
        
        <if test="loginIp != null and loginIp != ''">
        	and login_ip=#{loginIp} 
        </if>
        <if test="addTime != null">
        	and add_time=#{addTime} 
        </if>
        <if test="loginTime != null">
        	and login_time=#{loginTime} 
        </if>
        <if test="roleId != null">
        	and role_id=#{roleId} 
        </if>
        </trim>
    </sql>
    
    <sql id="sys_user_set_conditions">
    	<set>
        <if test="id != null">
        	id=#{id},
        </if>
        <if test="userName != null">
        	user_name=#{userName},
        </if>
        <if test="userPassword != null">
        	user_password=#{userPassword},
        </if>
        <if test="nickname != null">
        	nickname=#{nickname},
        </if>
        <if test="email != null">
        	email=#{email},
        </if>
        <if test="loginIp != null">
        	login_ip=#{loginIp},
        </if>
        <if test="addTime != null">
        	add_time=#{addTime},
        </if>
        <if test="loginTime != null">
        	login_time=#{loginTime},
        </if>
        <if test="roleId != null">
        	role_id=#{roleId},
        </if>
            id = id
        </set>
    </sql>

    <sql id="sys_user_properties">
        #{id},
        #{userName},
        #{userPassword},
        #{nickname},
        #{email},
        #{loginIp},
        #{addTime},
        #{loginTime},
        #{roleId}
    </sql>

    <insert id="createSysUser" parameterType="com.mlj.ecbiz.model.permission.SysUser" keyColumn="id" keyProperty="id" useGeneratedKeys="true" >
        insert INTO sys_user (<include refid="sys_user_columns"/>) VALUES (<include refid="sys_user_properties"/>)
    </insert>
	
	<insert id="insertSysUser" parameterType="com.mlj.ecbiz.model.permission.SysUser" keyColumn="id" keyProperty="id" useGeneratedKeys="true">
    	insert into sys_user
    	<trim prefix="(" suffix=")" suffixOverrides="," >
    			<if test="id != null" >
        			id,
    			</if>
    			<if test="userName != null" >
        			user_name,
    			</if>
    			<if test="userPassword != null" >
        			user_password,
    			</if>
    			<if test="nickname != null" >
        			nickname,
    			</if>
    			<if test="email != null" >
        			email,
    			</if>
    			<if test="loginIp != null" >
        			login_ip,
    			</if>
    			<if test="addTime != null" >
        			add_time,
    			</if>
    			<if test="loginTime != null" >
        			login_time,
    			</if>
    			<if test="roleId != null" >
        			role_id
    			</if>
    	</trim>
    	<trim prefix="values (" suffix=")" suffixOverrides="," >
    			<if test="id != null" >
        		#{id},
    		</if>
    			<if test="userName != null" >
        		#{userName},
    		</if>
    			<if test="userPassword != null" >
        		#{userPassword},
    		</if>
    			<if test="nickname != null" >
        		#{nickname},
    		</if>
    			<if test="email != null" >
        		#{email},
    		</if>
    			<if test="loginIp != null" >
        		#{loginIp},
    		</if>
    			<if test="addTime != null" >
        		#{addTime},
    		</if>
    			<if test="loginTime != null" >
        		#{loginTime},
    		</if>
    			<if test="roleId != null" >
        		#{roleId}
    		</if>
    	</trim>
  	</insert>
	
    <delete id="deleteSysUserById" parameterType="Long">
        delete from sys_user
        where
            		id = #{            			value
            		}
    </delete>
    
    <delete id="deleteSysUserByObj" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        delete from sys_user
        <include refid="sys_user_where_conditions"/>
    </delete>
    
  	<delete id="deleteSysUserByIdList" parameterType="java.util.List">
    	delete from sys_user 
        	where
            id
    		IN 
    		<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
				#{item}
			</foreach>
    </delete>

    <update id="updateSysUser" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        update sys_user SET
            id = #{id},
            user_name = #{userName},
            user_password = #{userPassword},
            nickname = #{nickname},
            email = #{email},
            login_ip = #{loginIp},
            add_time = #{addTime},
            login_time = #{loginTime},
            role_id = #{roleId}
        where
            id = #{id}
    </update>
    
    <update id="updateSysUserByObj" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        update sys_user 
        <include refid="sys_user_set_conditions"/>
        where
            id = #{id}
    </update>
    
    <update id="updateSysUserByObjAndConditions" parameterType="java.util.HashMap">
        update sys_user 
        <set>
        <if test="s.id != null">
        	id=#{s.id},
        </if>
        <if test="s.userName != null">
        	user_name=#{s.userName},
        </if>
        <if test="s.userPassword != null">
        	user_password=#{s.userPassword},
        </if>
        <if test="s.nickname != null">
        	nickname=#{s.nickname},
        </if>
        <if test="s.email != null">
        	email=#{s.email},
        </if>
        <if test="s.loginIp != null">
        	login_ip=#{s.loginIp},
        </if>
        <if test="s.addTime != null">
        	add_time=#{s.addTime},
        </if>
        <if test="s.loginTime != null">
        	login_time=#{s.loginTime},
        </if>
        <if test="s.roleId != null">
        	role_id=#{s.roleId},
        </if>
        </set>
        <where>
        <if test="c.id != null">
        	id=#{c.id} AND 
        </if>
        <if test="c.userName != null">
        	user_name=#{c.userName} AND 
        </if>
        <if test="c.userPassword != null">
        	user_password=#{c.userPassword} AND 
        </if>
        <if test="c.nickname != null">
        	nickname=#{c.nickname} AND 
        </if>
        <if test="c.email != null">
        	email=#{c.email} AND 
        </if>
        <if test="c.loginIp != null">
        	login_ip=#{c.loginIp} AND 
        </if>
        <if test="c.addTime != null">
        	add_time=#{c.addTime} AND 
        </if>
        <if test="c.loginTime != null">
        	login_time=#{c.loginTime} AND 
        </if>
        <if test="c.roleId != null">
        	role_id=#{c.roleId} AND 
        </if>
       (status!=2)
        </where>
    </update>
    
    <update id="batchUpdateSysUser" parameterType="java.util.List">
		update sys_user
		<trim prefix="set" suffixOverrides=",">
      	 	<trim prefix="id=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.id!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.id}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="user_name=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.userName!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.userName}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="user_password=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.userPassword!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.userPassword}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="nickname=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.nickname!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.nickname}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="email=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.email!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.email}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="login_ip=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.loginIp!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.loginIp}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="add_time=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.addTime!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.addTime}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="login_time=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.loginTime!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.loginTime}
					</if>
				</foreach>
			</trim>
      	 	<trim prefix="role_id=CASE" suffix="end,">
				<foreach collection="list" item="i" index="index">
					<if test="i.roleId!=null">
						WHEN 
            			id = #{i.id}
        				 THEN #{i.roleId}
					</if>
				</foreach>
			</trim>
		</trim>
		where
		<foreach collection="list" separator="or" item="i" index="index">
            	(id = #{i.id})
		</foreach>
	</update>
    
    

    <select id="getSysUserById" resultMap="SysUserResult" parameterType="Long">
        select
        <include refid="sys_user_columns"/>
        from sys_user
        where
            id = #{value}
    </select>
    
    <select id="getSysUserByObj" resultMap="SysUserResult" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        select
        <include refid="sys_user_columns"/>
        from sys_user
        <include refid="sys_user_where_conditions"/>
    </select>
	
    
    <select id="getSysUserListByObj" resultMap="SysUserResult"  parameterType="com.mlj.ecbiz.model.permission.SysUser">
        select
        <include refid="sys_user_columns"/>
        from sys_user 
        <include refid="sys_user_where_conditions"/>
    </select>
    
    <select id="getSysUserListByMap" resultMap="SysUserResult"  parameterType="java.util.HashMap">
        select
        <include refid="sys_user_columns"/>
        from sys_user 
        <include refid="sys_user_where_conditions"/>
        limit #{offset,jdbcType=INTEGER},#{limit,jdbcType=INTEGER} 
    </select>
    
    <select id="getSysUserCountByObj" resultType="int" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        select count(1) from sys_user
        <include refid="sys_user_where_conditions"/>
    </select>
    
    
    
    <select id="getSysUserIdByObj" resultType="Long" parameterType="com.mlj.ecbiz.model.permission.SysUser">
        select       id                   
        from sys_user
        <include refid="sys_user_where_conditions"/>
    </select>
	
    <select id="getSysUserIdList" resultType="Long" parameterType="com.mlj.ecbiz.model.permission.SysUser">
       select       id                    from sys_user where 1=1 
        id = #{value}
    </select>
    
    <select id="getSysUserIdListByObj" resultType="Long"  parameterType="com.mlj.ecbiz.model.permission.SysUser">
       select       id                    from sys_user 
        <include refid="sys_user_where_conditions"/>
    </select>
    
    <select id="getSysUserIdListByMap" resultType="Long"  parameterType="java.util.HashMap">
        select       id                    from sys_user 
        <include refid="sys_user_where_conditions"/>
        limit #{offset,jdbcType=INTEGER},#{limit,jdbcType=INTEGER} 
    </select>
</mapper>